# ü§ñ H∆∞·ªõng d·∫´n l·∫≠p tr√¨nh Chatbot v·ªõi C√¢u h·ªèi g·ª£i √Ω

## T·ªïng quan
H∆∞·ªõng d·∫´n n√†y m√¥ t·∫£ c√°ch implement h·ªá th·ªëng chatbot v·ªõi c√¢u h·ªèi g·ª£i √Ω c√≥ c√¢u tr·∫£ l·ªùi ƒë·ªãnh s·∫µn v√† fallback sang Gemini API cho c√°c c√¢u h·ªèi kh√°c.

## üéØ Logic x·ª≠ l√Ω

### 1. Ph√°t hi·ªán c√¢u h·ªèi g·ª£i √Ω
```typescript
const SUGGESTED_QUESTIONS = [
  "C√¢u l·∫°c b·ªô c√≥ nh·ªØng ho·∫°t ƒë·ªông g√¨?",
  "L√†m th·∫ø n√†o ƒë·ªÉ tham gia c√¢u l·∫°c b·ªô?", 
  "C√°c ban trong c√¢u l·∫°c b·ªô l√†m g√¨?",
  "Th·ªùi gian sinh ho·∫°t di·ªÖn ra khi n√†o?",
  "C·∫ßn k·ªπ nƒÉng g√¨ ƒë·ªÉ ·ª©ng tuy·ªÉn?",
  "C√¢u l·∫°c b·ªô ƒë∆∞·ª£c th√†nh l·∫≠p khi n√†o?",
  "C√¢u l·∫°c b·ªô c√≥ nh·ªØng th√†nh t√≠ch g√¨?"
];

const SUGGESTED_ANSWERS = {
  "C√¢u l·∫°c b·ªô c√≥ nh·ªØng ho·∫°t ƒë·ªông g√¨?": `FTC tri·ªÉn khai h·ªá sinh th√°i ho·∫°t ƒë·ªông h·ªçc thu·∫≠t v√† tr·∫£i nghi·ªám th·ª±c t·∫ø g·ªìm h·ªôi th·∫£o, t·ªça ƒë√†m v√† chuy√™n ƒë·ªÅ v·ªÅ FinTech, d·ªØ li·ªáu, tr√≠ tu·ªá nh√¢n t·∫°o, ng√¢n h√†ng s·ªë, th·ªã tr∆∞·ªùng v·ªën v√† qu·∫£n tr·ªã r·ªßi ro. B√™n c·∫°nh ƒë√≥ l√† cu·ªôc thi h·ªçc thu·∫≠t ATTACKER, chu·ªói talkshow v√† workshop, c√°c bu·ªïi training n·ªôi b·ªô, tham quan doanh nghi·ªáp nh∆∞ VNG, s·ª± ki·ªán h∆∞·ªõng nghi·ªáp Web3 Career Innovation v√† ho·∫°t ƒë·ªông g·∫Øn k·∫øt c·ªông ƒë·ªìng FTC Trip.`,
  
  "L√†m th·∫ø n√†o ƒë·ªÉ tham gia c√¢u l·∫°c b·ªô?": `B·∫°n theo d√µi Fanpage ƒë·ªÉ c·∫≠p nh·∫≠t ƒë·ª£t tuy·ªÉn th√†nh vi√™n v√† h∆∞·ªõng d·∫´n n·ªôp h·ªì s∆°. Link Fanpage: https://www.facebook.com/clbfintechuel. Th√¥ng b√°o s·∫Ω n√™u r√µ m·ªëc th·ªùi gian, ƒëi·ªÅu ki·ªán v√† quy tr√¨nh.`,
  
  "C√°c ban trong c√¢u l·∫°c b·ªô l√†m g√¨?": `Ban H·ªçc thu·∫≠t: Thi·∫øt k·∫ø n·ªôi dung cho workshop v√† talkshow, chu·∫©n b·ªã c√¢u h·ªèi cho t·ªça ƒë√†m, x√¢y d·ª±ng ng√¢n h√†ng c√¢u h·ªèi, ra ƒë·ªÅ v√† ch·∫•m cu·ªôc thi ATTACKER. Ban S·ª± ki·ªán: L·∫≠p k·∫ø ho·∫°ch v√† h·ªì s∆° t·ªï ch·ª©c, x√¢y d·ª±ng k·ªãch b·∫£n MC v√† timeline, ƒëi·ªÅu ph·ªëi h·∫≠u c·∫ßn v√† gi√°m s√°t th·ª±c thi t·∫°i hi·ªán tr∆∞·ªùng. Ban Truy·ªÅn th√¥ng: Thi·∫øt k·∫ø ·∫•n ph·∫©m, qu·∫£n l√Ω c√°c k√™nh truy·ªÅn th√¥ng, l·∫≠p k·∫ø ho·∫°ch n·ªôi dung v√† ph√°t tri·ªÉn h√¨nh ·∫£nh th∆∞∆°ng hi·ªáu c·ªßa c√¢u l·∫°c b·ªô. Ban T√†i ch√≠nh c√° nh√¢n: T·ªï ch·ª©c ƒë√†o t·∫°o v·ªÅ qu·∫£n l√Ω t√†i ch√≠nh c√° nh√¢n cho sinh vi√™n, ph√°t tri·ªÉn v√† c·∫≠p nh·∫≠t b·ªô b√†i MoneyWe, h·ªó tr·ª£ gi·∫£ng vi√™n ·ªü c√°c h·ªçc ph·∫ßn li√™n quan. Ban Nh√¢n s·ª±: Ph√¢n c√¥ng v√† theo d√µi ti·∫øn ƒë·ªô, b·∫£o ƒë·∫£m ngu·ªìn l·ª±c, tri·ªÉn khai ho·∫°t ƒë·ªông g·∫Øn k·∫øt v√† g√¨n gi·ªØ vƒÉn h√≥a t·ªï ch·ª©c.`,
  
  "Th·ªùi gian sinh ho·∫°t di·ªÖn ra khi n√†o?": `L·ªãch sinh ho·∫°t ƒë∆∞·ª£c c√¥ng b·ªë tr∆∞·ªõc tr√™n c√°c k√™nh n·ªôi b·ªô v√† Fanpage ƒë·ªÉ m·ªçi th√†nh vi√™n n·∫Øm b·∫Øt k·ªãp th·ªùi. T√πy ch∆∞∆°ng tr√¨nh, c√¢u l·∫°c b·ªô s·∫Ω th√¥ng b√°o r√µ th·ªùi gian, h√¨nh th·ª©c tham gia v√† y√™u c·∫ßu chu·∫©n b·ªã cho t·ª´ng ho·∫°t ƒë·ªông nh∆∞ talkshow, workshop, training ho·∫∑c s·ª± ki·ªán theo m√πa.`,
  
  "C·∫ßn k·ªπ nƒÉng g√¨ ƒë·ªÉ ·ª©ng tuy·ªÉn?": `FTC ch√†o ƒë√≥n ƒëa d·∫°ng chuy√™n ng√†nh. Tinh th·∫ßn h·ªçc h·ªèi, k·ª∑ lu·∫≠t v√† ch·ªß ƒë·ªông l√† n·ªÅn t·∫£ng quan tr·ªçng. Ki·∫øn th·ª©c n·ªÅn v·ªÅ Excel, SQL ho·∫∑c Python l√† l·ª£i th·∫ø khi tham gia c√°c n·ªôi dung d·ªØ li·ªáu v√† c√¥ng ngh·ªá t√†i ch√≠nh. K·ªπ nƒÉng vi·∫øt v√† thuy·∫øt tr√¨nh gi√∫p b·∫°n ƒë√≥ng g√≥p hi·ªáu qu·∫£ cho h·ªçc thu·∫≠t v√† truy·ªÅn th√¥ng. K·ªπ nƒÉng l√†m vi·ªác nh√≥m v√† qu·∫£n l√Ω th·ªùi gian h·ªó tr·ª£ b·∫°n theo k·ªãp ti·∫øn ƒë·ªô d·ª± √°n v√† s·ª± ki·ªán. ·ª®ng vi√™n quan t√¢m m·∫£ng s·ª± ki·ªán n√™n c√≥ t∆∞ duy t·ªï ch·ª©c v√† kh·∫£ nƒÉng ph·ªëi h·ª£p nhi·ªÅu ƒë·∫ßu vi·ªác. ·ª®ng vi√™n thi√™n v·ªÅ truy·ªÅn th√¥ng c·∫ßn kh·∫£ nƒÉng x√¢y d·ª±ng n·ªôi dung v√† th·∫©m m·ªπ th·ªã gi√°c.`,
  
  "C√¢u l·∫°c b·ªô ƒë∆∞·ª£c th√†nh l·∫≠p khi n√†o?": `FTC tr·ª±c thu·ªôc Khoa T√†i ch√≠nh v√† Ng√¢n h√†ng, Tr∆∞·ªùng ƒê·∫°i h·ªçc Kinh t·∫ø v√† Lu·∫≠t, ƒêHQG-HCM. C√¢u l·∫°c b·ªô ƒë∆∞·ª£c th√†nh l·∫≠p v√†o th√°ng m∆∞·ªùi m·ªôt nƒÉm 2020 d∆∞·ªõi s·ª± h∆∞·ªõng d·∫´n c·ªßa ThS. NCS Phan Huy T√¢m c√πng ƒë·ªôi ng≈© sinh vi√™n ng√†nh c√¥ng ngh·ªá t√†i ch√≠nh.`,
  
  "C√¢u l·∫°c b·ªô c√≥ nh·ªØng th√†nh t√≠ch g√¨?": `NƒÉm h·ªçc 2024‚Äì2025, FTC ƒë∆∞·ª£c Ban C√°n s·ª± ƒêo√†n ƒêHQG-HCM t·∫∑ng Gi·∫•y khen v√¨ ƒë√≥ng g√≥p t√≠ch c·ª±c cho c√¥ng t√°c ƒêo√†n v√† phong tr√†o thanh ni√™n. C√¢u l·∫°c b·ªô ƒë·ªìng th·ªùi v√†o Top 10 Nh√≥m 4 c·ªßa Gi·∫£i th∆∞·ªüng ƒê·ªïi m·ªõi s√°ng t·∫°o v√† Kh·ªüi nghi·ªáp TP.HCM I-STAR, ƒë∆∞·ª£c c·∫•p Gi·∫•y ch·ª©ng nh·∫≠n ghi nh·∫≠n n·ªó l·ª±c v√† ƒë√≥ng g√≥p trong ho·∫°t ƒë·ªông ƒë·ªïi m·ªõi s√°ng t·∫°o.`
};
```

### 2. H√†m ph√°t hi·ªán c√¢u h·ªèi g·ª£i √Ω
```typescript
function detectSuggestedQuestion(userQuestion: string): string | null {
  const normalizedQuestion = userQuestion.trim().toLowerCase();
  
  for (const suggestedQ of SUGGESTED_QUESTIONS) {
    const normalizedSuggested = suggestedQ.toLowerCase();
    
    // So s√°nh ch√≠nh x√°c
    if (normalizedQuestion === normalizedSuggested) {
      return suggestedQ;
    }
    
    // So s√°nh t∆∞∆°ng ƒë·ªëi (c√≥ th·ªÉ m·ªü r·ªông)
    const similarity = calculateSimilarity(normalizedQuestion, normalizedSuggested);
    if (similarity > 0.8) {
      return suggestedQ;
    }
  }
  
  return null;
}

function calculateSimilarity(str1: string, str2: string): number {
  // Implement similarity algorithm (Levenshtein, Jaccard, etc.)
  const words1 = str1.split(' ');
  const words2 = str2.split(' ');
  const intersection = words1.filter(word => words2.includes(word));
  return intersection.length / Math.max(words1.length, words2.length);
}
```

### 3. Logic x·ª≠ l√Ω ch√≠nh
```typescript
async function handleChatbotRequest(userQuestion: string, history: any[]) {
  // 1. Ki·ªÉm tra c√¢u h·ªèi g·ª£i √Ω tr∆∞·ªõc
  const matchedQuestion = detectSuggestedQuestion(userQuestion);
  
  if (matchedQuestion) {
    // Tr·∫£ v·ªÅ c√¢u tr·∫£ l·ªùi ƒë·ªãnh s·∫µn
    return {
      response: SUGGESTED_ANSWERS[matchedQuestion],
      source: 'suggested_question',
      mode: 'predefined'
    };
  }
  
  // 2. N·∫øu kh√¥ng ph·∫£i c√¢u h·ªèi g·ª£i √Ω, g·ªçi Gemini API
  return await callGeminiAPI(userQuestion, history);
}
```

### 4. Gemini API v·ªõi role c·ªë v·∫•n
```typescript
async function callGeminiAPI(userQuestion: string, history: any[]) {
  const GEMINI_SYSTEM_PROMPT = `B·∫°n l√† c·ªë v·∫•n h·ªçc t·∫≠p d√†nh cho t√¢n sinh vi√™n. H√£y gi·ªõi thi·ªáu ng·∫Øn g·ªçn, th√¢n thi·ªán v√† d·ªÖ hi·ªÉu v·ªÅ C√¢u l·∫°c b·ªô C√¥ng ngh·ªá t√†i ch√≠nh FTC c√πng ƒë·ªãnh h∆∞·ªõng ng√†nh h·ªçc li√™n quan. 

Th√¥ng tin n·ªÅn ƒë·ªÉ d√πng khi tr·∫£ l·ªùi: FTC tr·ª±c thu·ªôc Khoa T√†i ch√≠nh v√† Ng√¢n h√†ng, Tr∆∞·ªùng ƒê·∫°i h·ªçc Kinh t·∫ø v√† Lu·∫≠t, ƒêHQG-HCM, th√†nh l·∫≠p th√°ng 11/2020 d∆∞·ªõi s·ª± h∆∞·ªõng d·∫´n c·ªßa ThS. NCS Phan Huy T√¢m. Ho·∫°t ƒë·ªông ti√™u bi·ªÉu g·ªìm h·ªôi th·∫£o, t·ªça ƒë√†m v√† chuy√™n ƒë·ªÅ v·ªÅ FinTech, d·ªØ li·ªáu, tr√≠ tu·ªá nh√¢n t·∫°o, ng√¢n h√†ng s·ªë, th·ªã tr∆∞·ªùng v·ªën, qu·∫£n tr·ªã r·ªßi ro; cu·ªôc thi h·ªçc thu·∫≠t ATTACKER; chu·ªói talkshow v√† workshop; training n·ªôi b·ªô; tham quan doanh nghi·ªáp nh∆∞ VNG; s·ª± ki·ªán h∆∞·ªõng nghi·ªáp Web3 Career Innovation; ho·∫°t ƒë·ªông g·∫Øn k·∫øt c·ªông ƒë·ªìng FTC Trip. C∆° c·∫•u g·ªìm 5 ban chuy√™n m√¥n: H·ªçc thu·∫≠t, S·ª± ki·ªán, Truy·ªÅn th√¥ng, T√†i ch√≠nh c√° nh√¢n, Nh√¢n s·ª± (Ban ƒêi·ªÅu h√†nh gi·ªØ vai tr√≤ ƒë·ªãnh h∆∞·ªõng v√† ph√™ duy·ªát, kh√¥ng t√≠nh l√† ban chuy√™n m√¥n). C√°ch tham gia: theo d√µi Fanpage ƒë·ªÉ c·∫≠p nh·∫≠t ƒë·ª£t tuy·ªÉn v√† h∆∞·ªõng d·∫´n n·ªôp h·ªì s∆° (https://www.facebook.com/clbfintechuel). L·ªãch sinh ho·∫°t ƒë∆∞·ª£c c√¥ng b·ªë tr∆∞·ªõc tr√™n k√™nh n·ªôi b·ªô v√† Fanpage theo t·ª´ng ch∆∞∆°ng tr√¨nh. K·ªπ nƒÉng khuy·∫øn kh√≠ch: tinh th·∫ßn h·ªçc h·ªèi, k·ª∑ lu·∫≠t, ch·ªß ƒë·ªông; n·ªÅn t·∫£ng Excel, SQL ho·∫∑c Python l√† l·ª£i th·∫ø; k·ªπ nƒÉng vi·∫øt, thuy·∫øt tr√¨nh, l√†m vi·ªác nh√≥m v√† qu·∫£n l√Ω th·ªùi gian gi√∫p theo k·ªãp d·ª± √°n v√† s·ª± ki·ªán; thi√™n v·ªÅ s·ª± ki·ªán c·∫ßn t∆∞ duy t·ªï ch·ª©c, thi√™n v·ªÅ truy·ªÅn th√¥ng c·∫ßn nƒÉng l·ª±c x√¢y d·ª±ng n·ªôi dung v√† th·∫©m m·ªπ th·ªã gi√°c. Th√†nh t√≠ch: Gi·∫•y khen c·ªßa Ban C√°n s·ª± ƒêo√†n ƒêHQG-HCM nƒÉm h·ªçc 2024‚Äì2025; Top 10 Nh√≥m 4 Gi·∫£i th∆∞·ªüng I-STAR TP.HCM. Khi thi·∫øu d·ªØ li·ªáu chi ti·∫øt, h√£y n√≥i r√µ "t√†i li·ªáu ch∆∞a n√™u" v√† h∆∞·ªõng ng∆∞·ªùi h·ªèi sang Fanpage. Tr·∫£ l·ªùi b·∫±ng ti·∫øng Vi·ªát, m·∫°ch l·∫°c, kh√¥ng d√πng d·∫•u ";" ho·∫∑c g·∫°ch ƒë·∫ßu d√≤ng. ƒê·∫∑c bi·ªát h√£y tr·∫£ l·ªùi th√¢n thi·ªán t·ª± nhi√™n.`;

  const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);
  const model = genAI.getGenerativeModel({
    model: "gemini-1.5-flash",
    systemInstruction: GEMINI_SYSTEM_PROMPT,
    generationConfig: {
      temperature: 0.7,
      maxOutputTokens: 1000,
    }
  });

  const result = await model.generateContent({
    contents: [{ role: "user", parts: [{ text: userQuestion }] }]
  });

  return {
    response: result.response.text(),
    source: 'gemini',
    mode: 'ai_generated'
  };
}
```

## üîß Implementation trong API Route

### C·∫≠p nh·∫≠t `/app/api/chat/gemini/route.ts`
```typescript
export async function POST(req: NextRequest) {
  const body = await req.json();
  const userQuestion = extractUserQuestion(body);
  const history = body.history || [];

  // 1. Ki·ªÉm tra c√¢u h·ªèi g·ª£i √Ω
  const matchedQuestion = detectSuggestedQuestion(userQuestion);
  
  if (matchedQuestion) {
    return NextResponse.json({
      text: SUGGESTED_ANSWERS[matchedQuestion],
      reply: SUGGESTED_ANSWERS[matchedQuestion],
      response: SUGGESTED_ANSWERS[matchedQuestion],
      mode: "suggested_question",
      source: "predefined"
    });
  }

  // 2. Fallback sang Gemini
  const geminiResponse = await callGeminiAPI(userQuestion, history);
  
  return NextResponse.json({
    text: geminiResponse.response,
    reply: geminiResponse.response,
    response: geminiResponse.response,
    mode: "gemini",
    source: "ai_generated"
  });
}
```

## üé® UI Implementation

### C·∫≠p nh·∫≠t Suggested Questions trong UI
```typescript
// Trong app/chatbot/chat/page.tsx
const suggestedQuestions = [
  "C√¢u l·∫°c b·ªô c√≥ nh·ªØng ho·∫°t ƒë·ªông g√¨?",
  "L√†m th·∫ø n√†o ƒë·ªÉ tham gia c√¢u l·∫°c b·ªô?",
  "C√°c ban trong c√¢u l·∫°c b·ªô l√†m g√¨?",
  "Th·ªùi gian sinh ho·∫°t di·ªÖn ra khi n√†o?",
  "C·∫ßn k·ªπ nƒÉng g√¨ ƒë·ªÉ ·ª©ng tuy·ªÉn?",
  "C√¢u l·∫°c b·ªô ƒë∆∞·ª£c th√†nh l·∫≠p khi n√†o?",
  "C√¢u l·∫°c b·ªô c√≥ nh·ªØng th√†nh t√≠ch g√¨?"
];

// Khi user click v√†o suggested question
const handleSuggestedQuestion = (question: string) => {
  setInputValue(question);
  // T·ª± ƒë·ªông g·ª≠i c√¢u h·ªèi
  setTimeout(() => {
    handleSendMessage();
  }, 100);
};
```

## üìä Monitoring & Analytics

### Th√™m tracking cho suggested questions
```typescript
// Log khi s·ª≠ d·ª•ng suggested question
if (matchedQuestion) {
  console.log('Suggested question used:', {
    question: matchedQuestion,
    timestamp: new Date().toISOString(),
    userAgent: req.headers.get('user-agent')
  });
}
```

## üöÄ Deployment Checklist

- [ ] C·∫≠p nh·∫≠t API route v·ªõi logic ph√°t hi·ªán c√¢u h·ªèi g·ª£i √Ω
- [ ] Th√™m SUGGESTED_ANSWERS v√†o constants
- [ ] Test t·∫•t c·∫£ 7 c√¢u h·ªèi g·ª£i √Ω
- [ ] Test fallback sang Gemini cho c√¢u h·ªèi kh√°c
- [ ] Ki·ªÉm tra UI hi·ªÉn th·ªã suggested questions
- [ ] Deploy v√† test tr√™n production

## üîç Testing

### Test Cases
```typescript
const testCases = [
  {
    input: "C√¢u l·∫°c b·ªô c√≥ nh·ªØng ho·∫°t ƒë·ªông g√¨?",
    expected: "suggested_question",
    shouldMatch: true
  },
  {
    input: "FTC c√≥ ho·∫°t ƒë·ªông g√¨ kh√¥ng?",
    expected: "gemini",
    shouldMatch: false
  },
  {
    input: "L√†m sao ƒë·ªÉ join FTC?",
    expected: "suggested_question", 
    shouldMatch: true
  }
];
```

## üìù L∆∞u √Ω quan tr·ªçng

1. **Th·ª© t·ª± x·ª≠ l√Ω**: Lu√¥n ki·ªÉm tra suggested questions tr∆∞·ªõc khi g·ªçi Gemini
2. **Performance**: Suggested questions c√≥ response time nhanh h∆°n
3. **Consistency**: ƒê·∫£m b·∫£o c√¢u tr·∫£ l·ªùi ƒë·ªãnh s·∫µn ch√≠nh x√°c v√† c·∫≠p nh·∫≠t
4. **Fallback**: Gemini ch·ªâ ƒë∆∞·ª£c g·ªçi khi kh√¥ng match suggested questions
5. **User Experience**: Gi·ªØ tone th√¢n thi·ªán, t·ª± nhi√™n trong t·∫•t c·∫£ responses

## üéØ K·∫øt qu·∫£ mong ƒë·ª£i

- C√¢u h·ªèi g·ª£i √Ω ‚Üí Tr·∫£ l·ªùi ngay l·∫≠p t·ª©c v·ªõi n·ªôi dung ƒë·ªãnh s·∫µn
- C√¢u h·ªèi kh√°c ‚Üí G·ªçi Gemini API v·ªõi role c·ªë v·∫•n h·ªçc t·∫≠p
- T·∫•t c·∫£ responses ƒë·ªÅu th√¢n thi·ªán, t·ª± nhi√™n, kh√¥ng d√πng d·∫•u ";" ho·∫∑c g·∫°ch ƒë·∫ßu d√≤ng
- Links trong responses t·ª± ƒë·ªông tr·ªü th√†nh clickable links
